<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Graph Neural Networks | Divij Khaitan </title> <meta name="author" content="Divij Khaitan"> <meta name="description" content="A primer on Graph Neural Networks"> <meta name="keywords" content="Mathematics, Computer Science, Computational Mathematics, Machine Learning, Artifical Intelligence, Deep Learning, Neural Networks, Multi Armed Bandits"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://divijkhaitan.github.io/projects/gnn/"> <script src="/assets/js/theme.js?a5ca4084d3b81624bcfa01156dae2b8e"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Divij</span> Khaitan </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Graph Neural Networks</h1> <p class="post-description">A primer on Graph Neural Networks</p> </header> <article> <p>Traditional Neural Networks cannot handle graph structured data at all. They tend to completely ignore topological information, which can be invaluable since graphs can be used to model relationships across most domains. Graph Neural Networks provide a way to model these relationships. Geometric Deep Learning also looks at GNNs as a generalisation of traditional neural networks.</p> <h2 id="limitations-of-traditional-neural-networks">Limitations of Traditional Neural networks</h2> <p>The two major challenges with using traditional neural networks for graph structured data are size and invariance</p> <h4 id="size">Size</h4> <p>Neural Networks need inputs to be of a fixed size. For input modalities such as images, one can up/downsample images that are too small/large. With graphs, the number of nodes will often not be the same across all points in a dataset with no canonical way of adding/removing nodes without changing the graph itself. Additionally, the topological structure of a graph is much more complicated than for modalities such as text.</p> <h4 id="invariance">Invariance</h4> <p>Graphs are the same no matter how you permute them. Our understanding of the graph isomorphism problem (determining whether two graphs are identical) does not even tell us how difficult the problem is. This can introduce redundancy into the data, and if the architecture does not account for this invariance the network may be unable to learn patterns.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/graph_permutation.svg-480.webp 480w,/assets/img/graph_permutation.svg-800.webp 800w,/assets/img/graph_permutation.svg-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/graph_permutation.svg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="graph_permutation" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/original_image-480.webp 480w,/assets/img/original_image-800.webp 800w,/assets/img/original_image-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/original_image.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="original_image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/permuted_image-480.webp 480w,/assets/img/permuted_image-800.webp 800w,/assets/img/permuted_image-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/permuted_image.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="permuted_image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Permuting an image destroys the grid structure, changing it into a completely different image. </div> <h2 id="message-passing">Message Passing</h2> <p>One class of operations that meets the above criteria is message passing. Given a graph \(G = (V, E)\), the update function for the network is</p> <p>[h^{k+1}(v) = f(h^k(v), g({h^k(n): n \in N(v)}))]</p> <p>The above equation applies \(g\) to the hidden states of neighbours of node \(v\), denoted by \((N(v))\), and then applies \(f\) to the result and the hidden state of \(g\). Common choices for \(g\) include summation, component wise products, mean and max, while \(f\) can be a linear transformation, a non-linear transformation or a full neural network. Updates are usually calculated using a linear transformation followed by a nonlinear activation as it is for MLPs.</p> <p>The diagram below shows a single round of message passing. The nodes each have 3 features, being filled in with the RGB values corresponding to their colours. The update function is \(h^{k+1}(v) = f(h^k(v), g(\{h^k(n): n \in N(v)\})) = \frac{1}{\#(N(v))}\sum_{p \in N(v)} h^k(p)\), which computes the mean feature vector across all the neighbourhood of the node.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/gnn_initial.svg-480.webp 480w,/assets/img/gnn_initial.svg-800.webp 800w,/assets/img/gnn_initial.svg-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/gnn_initial.svg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="initial_state" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> A simple graph with 5 nodes. </div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/gnn_message.svg-480.webp 480w,/assets/img/gnn_message.svg-800.webp 800w,/assets/img/gnn_message.svg-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/gnn_message.svg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="message_creation" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Aggregation across the neighbourhoods of each node. </div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/gnn_final.svg-480.webp 480w,/assets/img/gnn_final.svg-800.webp 800w,/assets/img/gnn_final.svg-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/gnn_final.svg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="final_state" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Updating using neighbourhood mean. </div> <h2 id="graph-prediction-tasks">Graph Prediction Tasks</h2> <p>Graph prediction tasks can be done at the node, edge or graph level</p> <p>Node Prediction: The task here is to predict a property of a node from a node embedding. e.g. predicting the traffic on a new website using information from the websites that link to it</p> <p>Edge Prediction: The task here is to predict a property of an edge from an edge embedding. e.g. predicting the type of relationships between 2 nodes on a knowledge graph or making a recommendation based on past consumption history</p> <p>Graph prediction: The task here is to predict a property of a whole graph, usually after aggregation of it’s components to get a single embedding. e.g. predicting the melting point of a molecule or classifying a network based on its nodes and connection pattern</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/graph_tasks-480.webp 480w,/assets/img/graph_tasks-800.webp 800w,/assets/img/graph_tasks-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/graph_tasks.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="message_creation" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Different types of graph tasks. Credits: (<a href="https://towardsdatascience.com/graph-machine-learning-an-overview-c996e53fab90/" target="_blank" rel="external nofollow noopener"> Zach Blumenfield </a>) </div> <h2 id="smoothing-and-squashing">Smoothing and Squashing</h2> <p>Passing data through each layer of a GNN increases how far away information is being aggregated from for each node. After \(n\) passes, the representation of the node has information from all nodes which can be reached in at most \(n\) steps. If the same is true for every single node on the graph, the network may lose valuable node-level information because each of their representations are ‘smoothed’ across the entire graph. Graph properties like the diameter and centrality thus become critical design considerations when tuning hyperparameters.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/gnn_layers-480.webp 480w,/assets/img/gnn_layers-800.webp 800w,/assets/img/gnn_layers-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/gnn_layers.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="message_creation" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Layers of a GNN and which nodes contribute after a certain number of layers. Credits: (<a href="https://medium.com/data-science/do-we-need-deep-graph-neural-networks-be62d3ec5c59" target="_blank" rel="external nofollow noopener"> Michael Bronstein </a>) </div> <p>Squashing occurs for problems that require interactions from nodes that are far away from each other. Properties of certain chemicals depend on the interaction between molecules that are at opposite ends. If there happens to be ‘hub’ element, that connects different parts of the molecule together, a large amount of information is being squashed into a single node leading to a catastrophic information loss. This was introduced by Alon and Yahav in 2021 and remains a problem of interest.</p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Divij Khaitan. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?5d75c11f89cd96294bf5e6dd1ee1bb30"></script> <script defer src="/assets/js/common.js?fcfacfb8c6281f5e68d5a7d348186eb1"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>